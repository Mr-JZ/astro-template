# I18n Setup

Custom i18n using Astro's built-in internationalization — no external libraries. Pattern based on amz-visuals-website.

## Astro Config

```javascript
// astro.config.mjs
i18n: {
  defaultLocale: 'de',
  locales: ['de', 'en', 'fr', 'es'],
  routing: {
    prefixDefaultLocale: false, // de: /about, en: /en/about
  },
}
```

## File Structure

```
src/i18n/
├── ui.ts        # Translation dictionary (all languages)
└── utils.ts     # getLangFromUrl, useTranslations, useTranslatedPath
```

## Translation Dictionary (`src/i18n/ui.ts`)

```typescript
export const languages = {
  de: "Deutsch",
  en: "English",
  fr: "Français",
  es: "Español",
};

export const defaultLang = "de";

export const ui = {
  de: {
    "nav.home": "Startseite",
    "hero.title": "Titel",
  },
  en: {
    "nav.home": "Home",
    "hero.title": "Title",
  },
  // ... fr, es
} as const;
```

Uses dot-notation keys organized by feature/section.

## Helper Utilities (`src/i18n/utils.ts`)

```typescript
import { ui, defaultLang } from './ui';

export function getLangFromUrl(url: URL) {
  const [, lang] = url.pathname.split('/');
  if (lang in ui) return lang as keyof typeof ui;
  return defaultLang;
}

export function useTranslations(lang: keyof typeof ui) {
  return function t(key: keyof typeof ui[typeof defaultLang]) {
    return ui[lang][key] || ui[defaultLang][key];
  }
}

export function useTranslatedPath(lang: keyof typeof ui) {
  return function translatePath(path: string) {
    return lang === defaultLang ? path : `/${lang}${path}`;
  }
}
```

## Usage in Components

```astro
---
import { getLangFromUrl, useTranslations, useTranslatedPath } from '../i18n/utils';

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);
const translatePath = useTranslatedPath(lang);
---

<h1>{t('hero.title')}</h1>
<a href={translatePath('/kontakt/')}>{t('nav.contact')}</a>
```

## Routing

```
src/pages/
├── index.astro              # Default language (de) — /
├── leistungen.astro         # /leistungen/
└── [lang]/
    ├── index.astro          # /en/, /fr/, /es/
    └── leistungen.astro     # /en/leistungen/, etc.
```

Dynamic routes use `getStaticPaths()` to generate pages for non-default languages:

```astro
---
import { languages } from '../../i18n/ui';

export function getStaticPaths() {
  return Object.keys(languages)
    .filter(lang => lang !== 'de')
    .map(lang => ({ params: { lang } }));
}
---
```

## Language Picker

Use a `LanguagePicker.astro` component with `useTranslatedPath()` to generate correct URLs when switching languages.
